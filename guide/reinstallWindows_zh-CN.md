## Windows常用维护指南


### 安装系统
1. 下载系统映像  
你可以在以下站点免费获取各版本的Wuindows系统映像  
[itellyou](https://msdn.itellyou.cn/)  
[豆豆分享](https://www.iruanmi.com/msdn/)  
[复旦大学MVLS站点](http://mvls.fudan.edu.cn) (仅限复旦内网访问，需要UIS登录)   
*你需要下载批量许可版本来适配本指南下面的部分，否则你将会需要一个序列号来激活Windows系统。*
*你同时应当注意所下载的系统映像的版本和语言类型。*  
2. 制作启动U盘  
对于Windows用户，你可以使用UltraISO软件。使用其打开系统映像文件，然后点选菜单栏-启动-写入硬盘映像，将映像写入目标U盘中。  
对于Linux用户，你可以使用以下命令完成相同的操作。  
```shell  # umount the device before format.
	$ sudo umount -t fat32 /dev/<your_usb_device>
	# then format the device and turn filesystem info fat32
	$ sudo mkfs -t fat32 /dev/<your_usb_device>
	# use dd to write in.
	$ sudo dd if=<image_you_download> of=/dev/<your_usb_device>
```  
3. 从U盘启动	
首先你需要进入BIOS来调整你的电脑的启动顺序来保证你的电脑将会从U盘启动。  
进入BIOS的方式每个制造商的电脑都不尽相同。	
另一种方式是使用快速启动选单来对启动顺序进行单次的变更。  
不同制造商的的电脑的BIOS按键可以参照下表，不在下表中的制造商的电脑，可以通过屏幕上的提示
搜索引擎搜索或者依次尝试来找到正确的BIOS按键。
<table>
        <tr>
        <th>制造商</th>
        <th>BIOS按键</th>
        <th>快速启动选单按键</th>
        </tr>
        <tr><th>戴尔(DELL)</th><th>F2</th><th>F12</th></tr>
        <tr><th>华硕(ASUS)</th><th>Esc</th><th>F10</th></tr>
        <tr><th>Surface</th><th>音量键</th><th>
        <tr><th>苹果(Apple)</th><th></th><th>option</th></tr>
        <tr><th>ThinkPad</th><th>Enter</th><th>F12</th></tr>
        <tr><th>联想(Lenovo) 除去ThinkPad系列</th><th>F2</th><th>F12</th></tr>
    </table>
    
为了确保之后的步骤正常进行，请在BIOS选单中关闭“安全启动”(Safety Boot)。	
*不同制造商的BIOS中安全启动选项位于不同的选单，请予留意。*	

*部分制造商（例如华硕）的BIOS关闭“安全启动”需要设置BIOS密码才能关闭。*	

*对于部分制造商的电脑，你需要关闭“快速启动”才能进入到BIOS和快速启动选单，这个选项可以在BIOS中关闭。你可以通过<b>重新启动</b>你的电脑来在非快速启动模式下启动。*  

4. 安装Windows

**警告：在安装Windows操作系统之前，必须对系统分区的文件进行备份。应当注意的是，桌面、我的文档、图片、音乐、视频、下载在未更改路径的情况下均默认存储在系统分区。当你无法进入操作系统时，你应当通过PE系统来进行文件的备份操作。**		
以下以Windows 10的安装为例进行演示	

a. 当你运行Windows安装程序时，你将会看到以下界面。点击“现在安装”并等待安装程序启动。

![](image/welcome.png)	

接下来安装程序会要求你提供密钥（如果你下载的是批量许可版本将没有这一步），选择系统版本（如果你下载的是单版本映像将没有这一步），要求你同意许可协议，勾选同意后下一步。	

*对于非批量激活版本，你可以从[淘宝](http://www.taobao.com)购买一个Windows序列号或前往微软官方商城进行购买。*	

*如果电脑原先预装有<b>正版</b>Windows 10<b>家庭版</b>或<b>专业版</b>操作系统（OEM Home/OEM Pro），序列号将会被保存在主板芯片上，在这种情况下，你可以重新安装对应的版本而无需提供序列号，系统将会自动激活。*	

*你可以在安装过程中通过`shift` + `F10`组合键启动命令提示符并运行以下语句来获知当前已安装的Windows操作系统版本：```shell
        > dism /Image:<your old system path> /Get-CurrentEdition
    ```*
    
*如果你运行命令提示符有困难的话，你可以在PE中运行Dism++来获得相应信息。*

b. 接下来，安装程序会要求你选择“升级：安装Windows并保留文件、设置和应用程序”或“自定义：仅安装Windows（高级）”。第一个选项仅限于从Windows 7 (sp1)、Windows 8/8.1升级至Windows 10时使用，这将会在已有系统中启动安装程序进行Windows升级操作。除此之外，你均应当选择第二个选项。  
c. **重要：在此步骤中，你需要选择安装的目标驱动器**	 

![](image/disk.png)

如果你使用[UEFI](https://en.wikipedia.org/wiki/Unified_Extensible_Firmware_Interface)引导模式，你可以找到原先Windows操作系统的系统分区并将其格式化，然后选择这个分区进行安装。你也可以选择删除这个分区并重新创建一个。如果你希望能够更加干净的重新安装Windows操作系统的话，你可以选择删去RE、ESP和MSR分区（*但请不要删去OEM分区*）。		
如果你使用传统引导方式，你也可以进行类似的操作。但强烈建议转换成UEFI引导。尤其是当你使用Windows和Linux双系统时，使用UEFI引导将是必须的。关于转换到UEFI引导，请参见[从Legacy到UEFI](legacy_uefi.md).   
在完成这一步操作后，请等待安装程序运行。  
d. 当你看到以下界面时，请根据引导协助机主完成账户信息的完善。  

![](image/circle.png) 

**重要：如果你安装的是Windows 10企业版或教育版，除非机主对于用户域主动提出特别要求，当引导询问你是否要连接网络时，请选择左下角的“跳过此步骤”。如果你不幸点错，请选择“加入本地域”。**  
***特别提醒：一般应当建议机主选择英文用户名，以避免部分软件安装时出现异常。***  

e. 激活Windows。  
如果你安装了批量激活版本的Windows，你可以选择复旦信息办提供的激活脚本（要求每180内至少连接一次复旦内网），或是使用激活工具。  
如果你安装了非批量激活版本的Windows，且需要提供序列号，你可以点选右下角通知，点选所有设置，进入更新与安全，选择激活，输入产品密钥，输入序列号进行激活。  

f.安装驱动。  
你可以选择使用Windows自带的设备管理器对设备驱动程序进行更新。你可以右击此电脑，点选管理，在左侧选择设备管理器，选择设备右击更新设备驱动程序。  
你也可以通过各硬件制造商的官方网站下载并安装对应的驱动程序。  
如果Windows未能正确地自动安装网卡驱动导致无法上网，或者以上二种方法均不能操作时，你可以通过下载[驱动精灵](http://www.drivergenius.com/)来帮助你安装驱动程序。（对于网卡驱动未能正确安装的情形，你应当选择下载万能网卡版的驱动精灵）  
***特别提醒：在安装驱动精灵时，请特别注意安装程序中的捆绑软件。（尤其是安装选项中一个额外捆绑）***

![](image/drivergenius.png)

***在驱动安装完成后，请立即卸载驱动精灵。***  

g.更改桌面图标。  
当且仅当Windows已经被激活后，你才可以进行个性化设置。在刚安装好Windows的情况下，桌面上应当只有一个回收站图标。在桌面上右击，点选个性化，在左侧栏中选择主题，找到桌面图标设置，在其中更改桌面显示之图标。  

对于Windows 7系统，操作是类似的。
